<div class="jumbotron">
</div>
<div class="container">
  <div class="row">

    <% if user_signed_in? && current_user.admin? %>
      <%= render('layouts/adminsidenav') %>
    <% else %>
      <%= render('layouts/sidenav') %>
    <% end %>

    <div class="col-md-7">
      <% if params[:tag] %>
        <h2>Results for tag: <%= link_to('#'+params[:tag], params[:tag]) %></h2>
      <% end %>
      <% if params[:search] %>
        <h2><%= @events_found %> results for events with: <%= params[:search] %></h2>
      <% end %>
      <% @events.each do |event| %>
        <div class="card mb-2">
          <div class="card-body">
            <div class="row">
              <div class="col-md-4 first-picture">
                <%= image_tag(event.pictures.first, :alt => "Event picture", :class => "events-list-picture") if event.pictures.attached? %>
              </div>
              <div class="col-md-8">
                <%= link_to content_tag(:h5, event.name, :class => "card-title"), event_path(event)%>
                
                <h6 class="card-subtitle mb-2 text-muted"><%= event.place.name %></h6>
                <p class="card-text">
                  <strong><%= fa_icon "tags" %></strong>
                  <%=raw tag_links(event.all_tags)%>
                </p>
                <p class="card-text"><%= event.description %></p>
                <p class="card-text">Suitable for: <%= event.age_filter %> years old</p>
                <p class="card-text">Start: <%= time_format(event.start) %></p>
                <p class="card-text">End: <%= time_format(event.end) %></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>

      <% if params[:search] %>
        <h2><%= @places_found %> results for places with: <%= params[:search] %></h2>
          <% @places.each do |place| %>
            <div class="card mb-2">
              <div class="card-body">
                <div class="row">
                  <div class="col-md-4 first-picture">
                    <%= image_tag(place.picture, :alt => "place picture", :class => "place-picture") if place.picture.attached? %>
                  </div>
                  <div class="col-md-8">
                    <%= link_to content_tag(:h5, place.name, :class => "card-title"), place_path(place)%>
                    
                    <p class="card-text"><%= place.description %></p>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
      <% end %>

      <%= paginate @events, theme: 'twitter-bootstrap-4' %>
    </div>

    <div class="col-md-3">
      <%= render('layouts/advertisement') %>

      <div class="card mt-2">
        <div class="card-header">
          Featured Places
        </div>
        <%= render partial: "places/random",  collection: @random_places, as: "place" %>
      </div>

    </div>
  </div>
</div>